/*! For license information please see fullscreenChatV1.c57e14bd.chunk.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{18509:function(e,t,n){"use strict";n.r(t),n.d(t,"FullScreenChatInternal",(function(){return P})),n.d(t,"InstrumentedFullScreenChatV1",(function(){return k})),n.d(t,"InstrumentedFullScreenChatV2",(function(){return N})),n.d(t,"InstrumentedFullScreenChatWrapper",(function(){return T}));var a=n(5442),r=n.n(a),i=n(8218),c=n(6454),o=n(6458),d=n(5782),s=n(5579),l=n(5581),u=n(5587),b=n(8664),h=n(18409),v=n(15838),p=n(6722),g=n(18412),f=n(6720),w=n(6775),S=n(6911),O=n(6915),m=n(18414),C=n(15661),j=n(18425),y=n(18510),_=n(18428),E=n(18511),x=n(18513);function I(){return(I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var W=new Map,F=Object(c.a)(),P=e=>{var{isV2Bot:t}=e,n=Object(f.n)(window.location.pathname),c=Object(f.k)(window.location.pathname),{error:o,isWebChatSettingsInitialized:d}=Object(E.a)(n,c),s=window.location.search,l=new URLSearchParams(s),O=window.botCanvasSettings||{},C={cci_bot_id:n?O.botId||"":c,cci_tenant_id:O.tenantId||"",cci_environment_id:n||""};C.cci_tenant_id&&p.i.setCustomProperties({tenantId:C.cci_tenant_id});var y=l.get("headerText"),I=l.get("locale"),P=l.get("webChatHeaderStyleOptions"),L=l.get("webChatCanvasStyleOptions"),A=l.get("client"),k=l.get("embeddedAtOrigin");y&&(O.headerText=Object(w.nb)(y)),A&&(O.client=Object(w.nb)(A)),I&&(O.locale=Object(w.nb)(I)),k&&(O.embeddedAtOrigin=Object(w.nb)(k));try{O.webChatHeaderStyleOptions=P&&JSON.parse(Object(w.nb)(P))}catch(H){O.webChatHeaderStyleOptions=void 0}try{O.webChatCanvasStyleOptions=L&&JSON.parse(Object(w.nb)(L))}catch(J){O.webChatCanvasStyleOptions=void 0}var[N,T]=Object(a.useState)(!1),[D,R]=Object(_.a)(n?O.botId||"":c,C.cci_tenant_id,C.cci_environment_id,e=>{T(e)}),M=(()=>{p.i.startScenario(p.e.CreateStoreFullScreenChat,u.a.Create,{tenantId:C.cci_tenant_id});try{var e=t?[g.a]:[],n=t?[]:[x.a],a=t?p.r:void 0,r=Object(b.createStore)({},...e,Object(h.b)(C),Object(h.a)(Object(j.b)(W,p.e.BotMessageFullScreenChat,a),Object(j.a)(W,a),null==O?void 0:O.client),...n,h.d);return p.i.endScenario(p.e.CreateStoreFullScreenChat,p.f.Complete,void 0,{tenantId:C.cci_tenant_id}),r}catch(i){throw p.i.endScenario(p.e.CreateStoreFullScreenChat,p.f.Failed,i,{tenantId:C.cci_tenant_id}),i}})(),V=Object(i.a)(),U=F(e.styles,{theme:V}),z=N||!D&&!R||!d&&!o,B=()=>{try{var e;if("msportals"===O.client&&null!==(e=window.parent)&&void 0!==e&&e.postMessage&&O.embeddedAtOrigin&&O.embeddedAtOrigin===new URL(O.embeddedAtOrigin).origin)return!0}catch(t){return!1}return!1};return o||R?(B()&&O.embeddedAtOrigin&&window.parent.postMessage({ns:"PvaEmbeddedWebChat",type:"PvaLoadFailure",payload:{error:o,errorCode:R}},O.embeddedAtOrigin),null):(!z&&B()&&O.embeddedAtOrigin&&(window.parent.postMessage({ns:"PvaEmbeddedWebChat",type:"PvaLoadSuccess"},O.embeddedAtOrigin),e.trackEndPageLoad(t?p.r:void 0)),z||null==D?r.a.createElement(S.a,null):r.a.createElement("div",{className:U.fullScreenChat},r.a.createElement(v.a,{componentName:"FullScreenMemoizedChat"},r.a.createElement(m.a,{cciProperties:C,directLine:D,store:M}))))},L=Object(o.a)(P,y.a),A=Object(s.m)(O.n)(L),k=Object(l.R)(A,"/FullScreenChat",d.b.PowerVA,!0),N=Object(l.R)(A,"/FullScreenChat",d.b.PowerVA,!0,void 0,p.r),T=e=>{var t="2"===new URLSearchParams(window.location.search).get(C.a),n=t?N:k;return r.a.createElement(n,I({isV2Bot:t},e))};t.default=T},18510:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(6485),r=()=>({fullScreenChat:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",selectors:{".error-boundary":{display:"flex",width:"100%",wordBreak:"break-word",height:"100vh"},".error-content":{display:"flex",flexDirection:"column",margin:"auto",selectors:{h1:{marginTop:0,paddingTop:0},button:{minWidth:"100px"},"div, p":{textAlign:"center"},"h1, div, p, button":{marginLeft:"auto",marginRight:"auto"}}}}},errorPane:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",alignSelf:"center",justifyContent:"center",width:"100%"},errorMessage:{minWidth:"514px",fontSize:a.k.xLarge,lineHeight:"23px",textAlign:"center"}})},18511:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(5442),r=n(5587),i=n(18512),c=n(6722),o=n(18417);function d(e,t,n,a,r,i,c){try{var o=e[i](c),d=o.value}catch(s){return void n(s)}o.done?t(d):Promise.resolve(d).then(a,r)}var s=(e,t)=>{var[n,s]=Object(a.useState)(!1),[l,u]=Object(a.useState)(null),b={environmentId:e};return Object(a.useEffect)(()=>{(function(){var n,a=(n=function*(){c.i.startScenario(c.e.FetchWebChatSettings,r.a.Load,b);try{u(null);var n=yield(new i.a).getWebChatSettings(t,e);if(!n)throw new Error("fetchWebChatSettings returned null");window.botCanvasSettings=null==n?void 0:n.botCanvasSettings,window.chatSettingsUpdatedDateTime=new Date,s(!0),c.i.endScenario(c.e.FetchWebChatSettings,c.f.Complete,null,b)}catch(a){u(a),Object(o.b)(c.e.FetchWebChatSettings,a,b),c.i.trackException(a,"useInitializeWebChatSettings")}},function(){var e=this,t=arguments;return new Promise((function(a,r){var i=n.apply(e,t);function c(e){d(i,a,r,c,o,"next",e)}function o(e){d(i,a,r,c,o,"throw",e)}c(void 0)}))});return function(){return a.apply(this,arguments)}})()()},[t,e]),{error:l,isWebChatSettingsInitialized:n}}},18512:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(6209),r=n(5581),i=n(8266),c=n(6722),o=n(8170),d=n(6764),s=n(8270),l=n(18417),u=n(8262);function b(e,t,n,a,r,i,c){try{var o=e[i](c),d=o.value}catch(s){return void n(s)}o.done?t(d):Promise.resolve(d).then(a,r)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var i=e.apply(t,n);function c(e){b(i,a,r,c,o,"next",e)}function o(e){b(i,a,r,c,o,"throw",e)}c(void 0)}))}}function v(e,t){return Object(r.q)(e.replace("".concat(t,"/"),""))}class p{getWebChatSettings(e,t){var n=this;return h((function*(){Object(u.a)(Object(d.h)(t)&&Object(d.f)(t),l.c);var a=Object(i.b)().getEnvironmentEndpoint(t);return Object(u.a)(Object(d.h)(a)&&Object(d.f)(a),l.a),yield Object(s.a)(()=>n._getWebChatSettings(a,e))}))()}_getWebChatSettings(e,t){return h((function*(){var n="https://".concat(e,"/powervirtualagents/botsbyschema/").concat(t,"/webchatsettings?api-version=").concat(i.d);try{return(yield a.f.get(n,{operationName:v(n,t),knownServiceId:o.a.Engine})).data}catch(r){throw c.i.trackException(r,"WebChatSettingsService:getWebChatSettings"),r}}))()}}},18513:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(15661),r=e=>t=>n=>{if("DIRECT_LINE/CONNECT_FULFILLED"===n.type){var r=new URLSearchParams(window.location.search),i={};r.forEach((e,t)=>{t.startsWith(a.d)||(i[t]=e)}),Object.keys(i).length>0&&e.dispatch({type:"WEB_CHAT/SEND_EVENT",payload:{name:"pvaSetContext",value:i}})}return t(n)}}}]);
//# sourceMappingURL=https://sourcemaps.powerapps.com/srcmaps/static/js/module/fullscreenChatV1.c57e14bd.chunk.js.map